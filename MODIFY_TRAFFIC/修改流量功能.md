# 修改流量功能
上一章节已经已经捕获到流量，过滤出需要的信息，并且可以查看各请求的详细信息了，本章主要是介绍如何修改流量。

# AutoResponser
上章已经提到AutoReponser可以自动生成请求返回给请求方，不会转发给服务器，可以用来修改响应流量。

这里模拟实现一个修改baidu图片的例子

## 修改百度首页图片
```
1、在会话中找到GET /favicon.ico HTTP/1.1获取图片的请求
```
![baidu_favicon](https://tva4.sinaimg.cn/large/0082ZISugy1gazrlztckoj310m0kiq9a.jpg)

```
2、切换到AutoReponser页
3、新增规则，如果匹配到对应的请求就返回一张指定的图片
4、点击保存
```
![Fiddler_修改图片1](https://tva3.sinaimg.cn/large/0082ZISugy1gazrrwm93vj315p0n943r.jpg)

```
5、打开浏览器访问www.baidu.com，发现标题栏中的图标已经被替换了
```
![baidu_图片1](https://tvax2.sinaimg.cn/large/0082ZISugy1gazs0vvc67j30sa0er3zk.jpg)

采用以上的步骤，可以尝试将整个首页都成指定的图片，效果如下

![baidu_图片2](https://tvax4.sinaimg.cn/large/0082ZISugy1gazs04m4rcj30s70m076a.jpg)

# Composer
上章已经提到Composer发送一个请求，通过拖拽，可以修改客户端请求发送给服务器，可以用来修改请求流量。

这里模拟实现一个修改查询参数的例子

## 修改请求的查询参数
```
1、在百度首页输入'f'
2、在会话中找到GET /sugrec?pre=1&p=3&ie=utf-8&json=1&prod=pc&from=pc_web&sugsid=1425,21083,30489,30502&wd=f&req=2&csor=1&cb=jQuery110208162556214456214_1579261054802&_=1579261054803 HTTP/1.1查询的请求
```
![baidu_查询1](https://tva2.sinaimg.cn/large/0082ZISugy1gazsl356c4j315p0n9gu5.jpg)

```
2、切换到Composer页
3、拖拽查询请求到Composer页
4、修改查询参数‘f’为‘fiddler’
5、点击“Execute”
```
![baidu_查询2](https://tva4.sinaimg.cn/large/0082ZISugy1gazsmtnk88j315p0n9q99.jpg)

```
6、切换到Inspectors页，查看刚发出的请求的响应信息，可以看到已经更新为fiddler的查询内容
```
![baidu_查询3](https://tva3.sinaimg.cn/large/0082ZISugy1gazsodg3d5j315p0n947f.jpg)

# Breakpoint
# Automatic Breakpoints
修改请求/响应参数还可以通过设置断点，该功能入口在菜单栏Rules->Automatic Breakpoints

![Fiddler_autobreakpoint](https://tva1.sinaimg.cn/large/0082ZISugy1gazss1q648j30if0c2wgd.jpg)

- Before Request:在将请求发送到服务前之前设置断点
- After Request:在将响应发送到客户端之前设置断点

这种方法设置的断点是对会话框中的所有请求都生效

# bpu
用bpu命令对特定url设置断点，这种方式断点设在Before Requests。取消断点时只需要再执行bpu命令即可。

## 修改请求的查询参数，并返回一张指定图片
```
1、在会话框下方输入bpu命令，对上面查询‘f’的请求设置断点
```
![fiddler_bpu](https://tvax1.sinaimg.cn/large/0082ZISugy1gazt2eo54kj30ki0n8td2.jpg)

```
2、再次发送这个请求，在Inspectors页面会发现该请求被暂停
```
![fiddler_bpu_2](https://tva3.sinaimg.cn/large/0082ZISugy1gazt4jgn7wj30yk0n9tgs.jpg)

从上图看出，设置了断点之后有三种情况可以选择：
- Break On Response:相当于After Request，在将响应发送到客户端之前再次设置断点
- Run to Complete:不做任何操作
- Choose Response:相当于Composer给请求一个默认的响应值

```
3、在Inspectors页面修改查询参数‘f’为‘fiddler’
4、点击“Break On Response”，在页面上可以看到已经返回了响应，再次被暂停，此时“Break On Response”选项已经不可选了
```
![fiddler_bpu](https://tvax2.sinaimg.cn/large/0082ZISugy1gaztalp3yzj30yk0n9k0w.jpg)

```
5、修改响应数据，将第一条响应数据改为“我才不告诉你”
6、点击“Run to Complete”，可以看到响应参数已经被修改了
```

bpu命令还有很多，可以自行探索

